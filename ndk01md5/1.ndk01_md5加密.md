# <center>ndk之md5加密<center>
@[TOC](ndk01_md5加密)

## 踩坑

1. `native-lib.cpp中引入了md5.h`,报错：

![](cpp中引入还是报错.png)

`解决`：修改CMakeLists.txt为:

```
add_library( # Sets the name of the library.
             native-lib

             # Sets the library as a shared library.
             SHARED

             # Provides a relative path to your source file(s).
             //将md5.cpp加入到后面，中间使用空格
             native-lib.cpp md5.cpp)
```

2. MD5加密时 `16`位乱码时转`32`位时，应该声明长度为`33`

```
    // 3.MD5加密 C++ 和 java 大同小异,唯一不同的就是C++需要 自己回收内存
    MD5_CTX *ctx = new MD5_CTX();
    MD5Init(ctx);
    MD5Update(ctx, (unsigned char *) signature_str.c_str(), signature_str.length());
    unsigned char digest[16] = {0};
    MD5Final(digest,ctx);

    // 生成 32 位的字符串
    //md5_str[32]md5_str[33]留一位给/0结束符；
    //否则报数组越界。坑。。。。。。。。。。。。。。。。
    char md5_str[33] = {0};
    for(int i = 0; i < 16; i++){
        // 最终生成 32 位 ，不足的前面补0
        sprintf(md5_str,"%s%02x",md5_str,digest[i]);
    }

```
